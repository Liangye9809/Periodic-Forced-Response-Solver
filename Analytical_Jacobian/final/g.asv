
function [Ft, wt, Mft] = g(xt, kn, xn0, mu, kt, w_in, nloop) % xt, each rows correspond each time, columns are different dofs

    [N, M] = size(xt);
    Nx = M / 3;

    Ft = zeros(nloop * N, M);
    wt = zeros(2, Nx, nloop * N);

    Mft = zeros(5, Nx, N);

    for j = 1:nloop
        for i = 1:N
            [Ft(i, :), w, Mf] = gf(xt(i, :), kn, xn0, mu, kt, w_in);
            w_in = w; 
            Mft(:, :, (j - 1) * N + i) = Mf;
        end
    end
    
    
end